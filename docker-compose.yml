version: '3.8'

services:
  talanton-l1:
    build: .
    command: ["parthenond", "/configs/l1.conf", "--layer=l1"]
    ports: ["18332:18332", "18333:18333"]
    volumes:
      - ./configs/devnet:/configs:ro
      - ./genesis_talanton.json:/home/parthenon/genesis_talanton.json:ro

  drachma-l2:
    build: .
    command: ["parthenond", "/configs/l2.conf", "--layer=l2"]
    ports: ["19332:19332", "19333:19333"]
    volumes:
      - ./configs/devnet:/configs:ro
      - ./genesis_drachma.json:/home/parthenon/genesis_drachma.json:ro

  obolos-l3:
    build: .
    command: ["parthenond", "/configs/l3.conf", "--layer=l3"]
    ports: ["20332:20332", "20333:20333"]
    volumes:
      - ./configs/devnet:/configs:ro
      - ./genesis_obolos.json:/home/parthenon/genesis_obolos.json:ro

  relayer-l2:
    build: .
    command: ["/usr/local/bin/pantheon-relayer-l2"]
    depends_on: [drachma-l2, talanton-l1]

  relayer-l3:
    build: .
    command: ["/usr/local/bin/pantheon-relayer-l3"]
    depends_on: [obolos-l3, drachma-l2]
